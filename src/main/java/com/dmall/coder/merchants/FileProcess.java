package com.dmall.coder.merchants;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.util.Arrays;
import java.util.List;

/**
 * Description: 招商项目相关处理
 *
 * @Author Guangcai.xu
 * @Date 2019/2/25 9:42
 */
public class FileProcess {

    private static void process(String filePath) throws Exception {
        List<String> tables1 = Arrays.asList("goods_merchant,goods_merchant_brand,goods_merchant_face,goods_merchant_u,goods_conf_merchant".split(","));
        List<String> tables2 = Arrays.asList("goods_approval".split(","));

        List<String> tables1Data = Arrays.asList("112204,0120181026155181768,0000000987;316665,0120181230153913198,0000001367;641417,0120181123170138648,0000003363;112187,0120181122190642885,0000004479;112187,0120181122190642885,0000005395;316665,0120181230153913198,0000006416;332820,0120181211102263957,0000009328;332820,0120181211102263957,0000009329;332820,0120181211102263957,0000009330;332820,0120181211102263957,0000009331;316342,0120181201153567146,0000010910;316665,0120181230153913198,0000011259;316665,0120181230153913198,0000011824;316665,0120181230153913198,0000011825;316665,0120181230153913198,0000011826;112341,0120181219101069449,0000014314;316304,0120181230153913198,0000016389;111919,0120181217144017051,0000017294;113677,0120181213162122245,0000018386;113677,0120181213162122245,0000018387;113677,0120181213162122245,0000018388;113677,0120181213162122245,0000018389;640868,0120181121181454328,0000018893;316698,0120181230153913198,0000021514;316304,0120181230153913198,0000022134;316304,0120181230153913198,0000022136;105448,0120181108094351202,0000022167;103635,0120181127092583856,0000025032;103635,0120181127092583856,0000025036;103635,0120181127092583856,0000025279;316304,0120181230153913198,0000028317;316304,0120181230153913198,0000030908;112187,0120181122190642885,0000033866;317043,0120181228144015700,0000035092;317043,0120181228144015700,0000035097;316215,0120181230153913198,0000036043;316342,0120181201153567146,0000040270;641417,0120181123170138648,0000251231;112204,0120181026155181768,0000251281;316665,0120181230153913198,0000251787;317043,0120181228144015700,0000252015;316599,0120181112192757772,0000252092;105178,0120181112192757772,0000252208;316156,0120181113163222256,0000252403;316156,0120181113163222256,0000252405;316260,0120181130173870768,0000252421;316260,0120181130173870768,0000252425;316260,0120181130173870768,0000252427;316260,0120181130173870768,0000252433;316260,0120181130173870768,0000252447;316260,0120181130173870768,0000252587;316260,0120181130173870768,0000252589;112187,0120181122190642885,0000253319;316143,0120181201160925641,0000253427;113405,0120181122145846669,0000253473;316400,0120181122145846669,0000253800;316342,0120181201153567146,0000254084;316342,0120181201153567146,0000254086;102413,0120181217144017051,0000254385;316223,0120181219101069449,0000254442;316223,0120181219101069449,0000254444;316303,0120181229130680699,0000254658;316420,0120181220200844629,0000254684;316304,0120181230153913198,0000254940;316303,0120181229130680699,0000254943;316215,0120181230153913198,0000255012;316215,0120181230153913198,0000255016;316215,0120181230153913198,0000255017;316215,0120181230153913198,0000255018;316216,0120181229130680699,0000255040;316216,0120181229130680699,0000255049".split(";"));

        BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(filePath)));
        tables1.forEach(table -> {
            tables1Data.forEach(s -> {
                String[] arr = s.split(",");
                String supplierCard = arr[0];
                String tenderCode = arr[1];
                String goodsCode = arr[2];
                String deleteStr;
                deleteStr = "delete from " + table + " where merchant_no='" + tenderCode + "' and supplier_code='" + supplierCard + "' and goods_code='" + goodsCode + "';";
                System.out.println(deleteStr);
            });
        });

    }

    public static void main(String[] args) throws Exception {
        String filePath = "C:\\Users\\19223\\Desktop\\朱立志要删某个供商的商品.txt";
        process(filePath);
    }
}